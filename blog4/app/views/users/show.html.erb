<p id="notice"><%= notice %></p>

<% if user_signed_in? %>
  <% unless current_user.id == @user.id %>
    <% if current_user.followings.find_by_id(@user.id).nil? %>
      <p>您还没有关注Ta</p>
      <form method="post" action="<%=followships_url %>">
        <input type="hidden" name='followship[user_id]' value=<%=current_user.id %>>
        <input type="hidden" name='followship[following_user_id]' value=<%=@user.id %>>
        <input type="submit" name="关注他" value="关注他">
      </form>
    <% else %>
      <p>您已经关注了该用户</p>
      <%@followship= Followship.find(current_user.followships.where('following_user_id='+@user.id.to_s).first.id)%>
      <%= link_to '点击取消关注', @followship, method: :delete, data: { confirm: 'Are you sure?' } %>
    <% end %>
  <% end %>
<% else %>
  <p>想要关注该用户，请先<%= link_to "登录", new_user_session_path %></p>
<% end %>

<h1>用户详情</h1>

<p>
  <% if current_user.id == @user.id %>
    <strong>你的邮箱:</strong>
  <% else %>
    <strong>Ta的邮箱:</strong>
  <% end %>
  <%= @user.email %>
</p>

<p>
  <strong>关注的用户:</strong>
  <% @followings.each do |x| %>
    <%= x.email %>
  <% end %>
</p>

<p>
  <strong>被以下用户关注:</strong>
  <% @followers.each do |x| %>
    <%= x.email %>
  <% end %>
</p>

